# Comparing `tmp/vitriolic-3.3.0-py3-none-any.whl.zip` & `tmp/vitriolic-3.3.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 2937888 bytes, number of entries: 972
+Zip file size: 2938030 bytes, number of entries: 972
 -rw-r--r--  2.0 unx      110 b- defN 19-Oct-31 21:17 tests/.coveragerc
 -rw-r--r--  2.0 unx       32 b- defN 19-Oct-31 21:17 tests/.gitignore
 -rw-r--r--  2.0 unx        0 b- defN 19-Oct-18 22:04 tests/__init__.py
 -rw-r--r--  2.0 unx       19 b- defN 22-Jun-12 11:19 tests/constraints-dj22.txt
 -rw-r--r--  2.0 unx       19 b- defN 22-Jun-12 11:19 tests/constraints-dj32.txt
 -rw-r--r--  2.0 unx       19 b- defN 22-Jun-12 11:19 tests/constraints-dj40.txt
 -rw-r--r--  2.0 unx      815 b- defN 19-Oct-18 22:04 tests/manage.py
@@ -686,31 +686,31 @@
 -rw-r--r--  2.0 unx     1864 b- defN 22-Jun-12 11:19 touchtechnology/news/templatetags/news.py
 -rw-r--r--  2.0 unx        0 b- defN 19-Oct-18 22:04 touchtechnology/news/tests/__init__.py
 -rw-r--r--  2.0 unx      982 b- defN 22-Jun-12 11:19 touchtechnology/news/tests/factories.py
 -rw-r--r--  2.0 unx     2557 b- defN 22-Jun-12 11:19 touchtechnology/news/tests/test_admin.py
 -rw-r--r--  2.0 unx     3442 b- defN 22-Jun-12 11:19 touchtechnology/news/tests/test_site.py
 -rw-r--r--  2.0 unx        0 b- defN 19-Oct-18 22:04 tournamentcontrol/__init__.py
 -rw-r--r--  2.0 unx      366 b- defN 19-Nov-19 06:59 tournamentcontrol/competition/__init__.py
--rw-r--r--  2.0 unx    82942 b- defN 23-Jul-16 04:15 tournamentcontrol/competition/admin.py
+-rw-r--r--  2.0 unx    82639 b- defN 23-Jul-16 13:50 tournamentcontrol/competition/admin.py
 -rw-r--r--  2.0 unx     2796 b- defN 23-Feb-16 20:24 tournamentcontrol/competition/apps.py
 -rw-r--r--  2.0 unx     4268 b- defN 19-Oct-18 22:04 tournamentcontrol/competition/calc.py
 -rw-r--r--  2.0 unx     1361 b- defN 23-May-21 21:21 tournamentcontrol/competition/constants.py
 -rw-r--r--  2.0 unx    10047 b- defN 22-Jun-12 22:50 tournamentcontrol/competition/dashboard.py
 -rw-r--r--  2.0 unx    12977 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/decorators.py
 -rw-r--r--  2.0 unx    18623 b- defN 23-Feb-16 20:24 tournamentcontrol/competition/draw.py
 -rw-r--r--  2.0 unx      269 b- defN 19-Oct-18 22:04 tournamentcontrol/competition/fields.py
 -rw-r--r--  2.0 unx    70923 b- defN 23-Jul-16 04:15 tournamentcontrol/competition/forms.py
 -rw-r--r--  2.0 unx      467 b- defN 19-Oct-18 22:04 tournamentcontrol/competition/managers.py
 -rw-r--r--  2.0 unx     4705 b- defN 23-Jul-16 02:28 tournamentcontrol/competition/merge.py
 -rw-r--r--  2.0 unx     1517 b- defN 19-Oct-31 21:17 tournamentcontrol/competition/mixins.py
--rw-r--r--  2.0 unx    72140 b- defN 23-Jul-16 04:15 tournamentcontrol/competition/models.py
+-rw-r--r--  2.0 unx    71222 b- defN 23-Jul-16 13:50 tournamentcontrol/competition/models.py
 -rw-r--r--  2.0 unx     5029 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/query.py
 -rw-r--r--  2.0 unx    12590 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/rank.py
 -rw-r--r--  2.0 unx    43575 b- defN 23-May-21 21:21 tournamentcontrol/competition/sites.py
--rw-r--r--  2.0 unx     1269 b- defN 23-May-28 02:11 tournamentcontrol/competition/tasks.py
+-rw-r--r--  2.0 unx     1978 b- defN 23-Jul-16 13:50 tournamentcontrol/competition/tasks.py
 -rw-r--r--  2.0 unx    17461 b- defN 23-Jul-16 03:48 tournamentcontrol/competition/utils.py
 -rw-r--r--  2.0 unx      227 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/validators.py
 -rw-r--r--  2.0 unx     8084 b- defN 22-Jul-03 22:11 tournamentcontrol/competition/wizards.py
 -rw-r--r--  2.0 unx      421 b- defN 19-Nov-09 20:04 tournamentcontrol/competition/locale/de/LC_MESSAGES/django.mo
 -rw-r--r--  2.0 unx    63237 b- defN 19-Nov-09 20:04 tournamentcontrol/competition/locale/de/LC_MESSAGES/django.po
 -rw-r--r--  2.0 unx      429 b- defN 19-Nov-09 20:04 tournamentcontrol/competition/locale/en-AU/LC_MESSAGES/django.mo
 -rw-r--r--  2.0 unx    63245 b- defN 19-Nov-09 20:04 tournamentcontrol/competition/locale/en-AU/LC_MESSAGES/django.po
@@ -962,13 +962,13 @@
 -rw-r--r--  2.0 unx     1837 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/tests/test_dashboard.py
 -rw-r--r--  2.0 unx     2299 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/tests/test_draw.py
 -rw-r--r--  2.0 unx     7104 b- defN 23-May-21 21:14 tournamentcontrol/competition/tests/test_formsets.py
 -rw-r--r--  2.0 unx     4308 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/tests/test_rank.py
 -rw-r--r--  2.0 unx     1925 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/tests/test_signals.py
 -rw-r--r--  2.0 unx     1240 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/tests/test_utils.py
 -rw-r--r--  2.0 unx      339 b- defN 22-Jun-12 11:19 tournamentcontrol/competition/tests/urls.py
--rw-r--r--  2.0 unx     1524 b- defN 23-Jul-16 04:17 vitriolic-3.3.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     5079 b- defN 23-Jul-16 04:17 vitriolic-3.3.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-16 04:17 vitriolic-3.3.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       34 b- defN 23-Jul-16 04:17 vitriolic-3.3.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx   114889 b- defN 23-Jul-16 04:17 vitriolic-3.3.0.dist-info/RECORD
-972 files, 8462534 bytes uncompressed, 2744100 bytes compressed:  67.6%
+-rw-r--r--  2.0 unx     1524 b- defN 23-Jul-16 13:52 vitriolic-3.3.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5079 b- defN 23-Jul-16 13:52 vitriolic-3.3.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-16 13:52 vitriolic-3.3.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       34 b- defN 23-Jul-16 13:52 vitriolic-3.3.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx   114889 b- defN 23-Jul-16 13:52 vitriolic-3.3.1.dist-info/RECORD
+972 files, 8462022 bytes uncompressed, 2744242 bytes compressed:  67.6%
```

## zipnote {}

```diff
@@ -2895,23 +2895,23 @@
 
 Filename: tournamentcontrol/competition/tests/test_utils.py
 Comment: 
 
 Filename: tournamentcontrol/competition/tests/urls.py
 Comment: 
 
-Filename: vitriolic-3.3.0.dist-info/LICENSE
+Filename: vitriolic-3.3.1.dist-info/LICENSE
 Comment: 
 
-Filename: vitriolic-3.3.0.dist-info/METADATA
+Filename: vitriolic-3.3.1.dist-info/METADATA
 Comment: 
 
-Filename: vitriolic-3.3.0.dist-info/WHEEL
+Filename: vitriolic-3.3.1.dist-info/WHEEL
 Comment: 
 
-Filename: vitriolic-3.3.0.dist-info/top_level.txt
+Filename: vitriolic-3.3.1.dist-info/top_level.txt
 Comment: 
 
-Filename: vitriolic-3.3.0.dist-info/RECORD
+Filename: vitriolic-3.3.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## tournamentcontrol/competition/admin.py

```diff
@@ -94,14 +94,15 @@
     UndecidedTeam,
     Venue,
 )
 from tournamentcontrol.competition.sites import CompetitionAdminMixin
 from tournamentcontrol.competition.tasks import (
     generate_pdf_grid,
     generate_pdf_scorecards,
+    set_youtube_thumbnail,
 )
 from tournamentcontrol.competition.utils import (
     generate_fixture_grid,
     generate_scorecards,
     legitimate_bye_match,
     match_unplayed,
     team_needs_progressing,
@@ -1585,18 +1586,15 @@
                     else:
                         body["id"] = obj.external_identifier
                         broadcast = (
                             season.youtube.liveBroadcasts()
                             .update(part="snippet,status,contentDetails", body=body)
                             .execute()
                         )
-                        season.youtube.thumbnails().set(
-                            videoId=obj.external_identifier,
-                            media_body=obj.live_stream_thumbnail_media_body,
-                        ).execute()
+                        set_youtube_thumbnail.delay(obj.pk)
                         log.info("YouTube video %(id)r updated", broadcast)
 
                 # If we have enabled live-streaming, but don't have an external id, we
                 # need to create an event with the YouTube API and store the external
                 # id.
                 elif obj.live_stream:
                     broadcast = (
@@ -1604,18 +1602,15 @@
                         .insert(
                             part="id,snippet,status,contentDetails",
                             body=body,
                         )
                         .execute()
                     )
                     obj.external_identifier = broadcast["id"]
-                    season.youtube.thumbnails().set(
-                        videoId=obj.external_identifier,
-                        media_body=obj.live_stream_thumbnail_media_body,
-                    ).execute()
+                    set_youtube_thumbnail.delay(obj.pk)
                     video_link = f"https://youtu.be/{obj.external_identifier}"
                     obj.videos = (
                         [video_link]
                         if obj.videos is None
                         else obj.videos.append(video_link)
                     )
                     log.info("YouTube video %(id)r inserted", broadcast)
```

## tournamentcontrol/competition/models.py

```diff
@@ -625,28 +625,14 @@
                 "https://www.googleapis.com/auth/youtube.upload",
                 "https://www.googleapis.com/auth/youtubepartner",
             ],
             **kwargs,
         )
 
     @cached_property
-    def live_stream_thumbnail_media_body(self):
-        try:
-            res = requests.get(self.live_stream_thumbnail)
-            res.raise_for_status()
-        except HTTPError:
-            return None
-        media = MediaInMemoryUpload(
-            res.content,
-            mimetype=res.headers["Content-Type"],
-            resumable=True,
-        )
-        return media
-
-    @cached_property
     def youtube(self):
         return build(
             "youtube",
             "v3",
             credentials=Credentials(
                 client_id=self.live_stream_client_id,
                 client_secret=self.live_stream_client_secret,
@@ -1686,30 +1672,14 @@
     live_stream_bind = models.CharField(
         max_length=50, blank=True, null=True, db_index=True
     )
     live_stream_thumbnail = models.URLField(blank=True, null=True)
 
     objects = MatchManager()
 
-    @cached_property
-    def live_stream_thumbnail_media_body(self):
-        if not self.live_stream_thumbnail:
-            return self.stage.division.season.live_stream_thumbnail_media_body
-        try:
-            res = requests.get(self.live_stream_thumbnail)
-            res.raise_for_status()
-        except HTTPError:
-            return None
-        media = MediaInMemoryUpload(
-            res.content,
-            mimetype=res.headers["Content-Type"],
-            resumable=True,
-        )
-        return media
-
     class Meta:
         get_latest_by = "datetime"
         ordering = (
             "date",
             "stage",
             "round",
             "is_bye",
```

## tournamentcontrol/competition/tasks.py

```diff
@@ -1,10 +1,12 @@
 import base64
 
+import requests
 from celery import shared_task
+from googleapiclient.http import MediaInMemoryUpload
 
 from tournamentcontrol.competition.models import Match, Stage
 from tournamentcontrol.competition.utils import (
     generate_fixture_grid,
     generate_scorecards,
 )
 
@@ -34,7 +36,31 @@
         format="pdf",
         extra_context=extra_context,
         http_response=False,  # Get bytes back, not a response object
     )
     # We can't JSON encode bytes, so we need to base64 encode the
     # PDF document before handing it back to the result backend.
     return base64.b64encode(data).decode("utf8")
+
+
+@shared_task
+def set_youtube_thumbnail(match_pk):
+    """
+    Asynchronously use the Google YouTube Data API to set the thumbnail for
+    the match specified.
+    """
+    obj = Match.objects.get(pk=match_pk)
+    season = obj.stage.division.season
+
+    img = requests.get(obj.live_stream_thumbnail or season.live_stream_thumbnail)
+    img.raise_for_status()
+
+    media_body = MediaInMemoryUpload(
+        img.content,
+        mimetype=img.headers["Content-Type"],
+        resumable=True,
+    )
+
+    obj.stage.division.season.youtube.thumbnails().set(
+        videoId=obj.external_identifier,
+        media_body=media_body,
+    ).execute()
```

## Comparing `vitriolic-3.3.0.dist-info/LICENSE` & `vitriolic-3.3.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `vitriolic-3.3.0.dist-info/METADATA` & `vitriolic-3.3.1.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: vitriolic
-Version: 3.3.0
+Version: 3.3.1
 Summary: A suite of packages for the Django framework to provide integrated Content Management and Sports Administration functionality for sporting associations.
 Author-email: Gary Reynolds <gary@touch.asn.au>
 License: BSD 3-Clause License
         
         Copyright (c) 2016, Touch Technology Pty Ltd
         All rights reserved.
```

## Comparing `vitriolic-3.3.0.dist-info/RECORD` & `vitriolic-3.3.1.dist-info/RECORD`

 * *Files 1% similar despite different names*

```diff
@@ -685,31 +685,31 @@
 touchtechnology/news/templatetags/news.py,sha256=vgyrw9VwbQ-LWNPUAbKLQhEMYj8Motxni9uhUW2lw5M,1864
 touchtechnology/news/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 touchtechnology/news/tests/factories.py,sha256=RbXKNlva7ainKuAg6Ioj9SYfZNKonHR_Qp-Fo0w-ij4,982
 touchtechnology/news/tests/test_admin.py,sha256=pfVQ29EcTdhgtsMpTw7h2TRnIMei-ucUiFrjsbLwXK4,2557
 touchtechnology/news/tests/test_site.py,sha256=hyNDZnqLOgm_MjD0Rj45TLmtmX5WzNCDuenKb2zx9Jw,3442
 tournamentcontrol/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tournamentcontrol/competition/__init__.py,sha256=SScx6_SbKoERyLSjExClsmjSzEkS9rClPjVu8-dVwPE,366
-tournamentcontrol/competition/admin.py,sha256=CdUOWfM7tRzORjVoEYJ5pe3dKWvy8hMjGL3ia1Hv1Sg,82942
+tournamentcontrol/competition/admin.py,sha256=Yci0_JdKi_6RpDk4SwnEXGU76Mz8nLD-3kRD2-pMqm4,82639
 tournamentcontrol/competition/apps.py,sha256=dGwA7hShn-F2G4IIz1Q1osKvpIj6WTBXh3E08Uv-6r8,2796
 tournamentcontrol/competition/calc.py,sha256=2VV4FlZ7afkHKArOJwibAAv8K62j1u49PGCnzydcIOM,4268
 tournamentcontrol/competition/constants.py,sha256=Z0qYTgO9-4hS_Hipglk05nDsQYh6Q5gC4Gx_Qjqf-Zs,1361
 tournamentcontrol/competition/dashboard.py,sha256=MonuXxpdJ8RnpMco7sCQEoLSpPMrXgFaASv4IwkzOjw,10047
 tournamentcontrol/competition/decorators.py,sha256=kjf6xJM0qmcM128JSzUjjkbRMPnV-C0y4LGXPhoYKFs,12977
 tournamentcontrol/competition/draw.py,sha256=SMeS_2mmMNZQ1m8SStzl7xmLcTYKm9sxM6ETA52eRdw,18623
 tournamentcontrol/competition/fields.py,sha256=jvxu2BBJT5qVHrhSbdmJmeYdQbPQ_LBFtoHjlC7fkU4,269
 tournamentcontrol/competition/forms.py,sha256=GN_KRSxqqRpsMQGTLq_bFyfaE5eTRAO8SfL_doAMep0,70923
 tournamentcontrol/competition/managers.py,sha256=F8XO8Mk8hTI2nL-Sn5J6J0PSYQFxeOiuEZIyzG3L2Ok,467
 tournamentcontrol/competition/merge.py,sha256=WopN_fsAxsR6EFxF52rxP16BAFf-pNNjldOcbLOshOk,4705
 tournamentcontrol/competition/mixins.py,sha256=ktlQo57ijBOdfSHYKOiVErxLRfa1rywtp6LhM-7gyM8,1517
-tournamentcontrol/competition/models.py,sha256=OYkWGzQhUowLGgglcfYg5CpjnHVpg5G3X-e3XIg38bY,72140
+tournamentcontrol/competition/models.py,sha256=qgC_9CFVEdL6EZts_gikzII6JjTTOaeRz1HYD_n8B_g,71222
 tournamentcontrol/competition/query.py,sha256=qmwXGRd5wr9d8yfrPIqf1bGO8mxA8DyBIMh6agDJVvk,5029
 tournamentcontrol/competition/rank.py,sha256=PkdXw37-4dU0e9GVks2-eIvNAf0BKNCD9yzCg1hCl0I,12590
 tournamentcontrol/competition/sites.py,sha256=s0lqR3voEmno1VVTyo0-767fGFtlAEyu2jWee1sef68,43575
-tournamentcontrol/competition/tasks.py,sha256=cpLpCuhIjHK1eDv9HKZiTu_Dca0P0aZx0M8RbTqcuzI,1269
+tournamentcontrol/competition/tasks.py,sha256=Y6fm1q9I9mX6IrVpQX9bbsPzX7IYwjmig12uPNoPnO0,1978
 tournamentcontrol/competition/utils.py,sha256=bhHWli2RiCIDsQkGoa9BNw9NEJBF0BU6rfCLqOBL2Ao,17461
 tournamentcontrol/competition/validators.py,sha256=lS4Kyu2heNBcu3wyrBnrKG4RcI3nByeqW8FZdISWdCU,227
 tournamentcontrol/competition/wizards.py,sha256=1qH4lQ-M_Crh4E29Io-M5Tm53Kt8GSefyjL0DMu8pK8,8084
 tournamentcontrol/competition/locale/de/LC_MESSAGES/django.mo,sha256=SczEO1gvt51z2BvZd_Y5MtPc-yxAhl8L7NyO7TC6Fk8,421
 tournamentcontrol/competition/locale/de/LC_MESSAGES/django.po,sha256=RYU42Dc6LM1wGrWoTUPAFgnbARzvNGcCUKEKOO67TlE,63237
 tournamentcontrol/competition/locale/en-AU/LC_MESSAGES/django.mo,sha256=kPj05rISURKCsDY6tLqkT2vantNt6kcOHBqPxKmP2jg,429
 tournamentcontrol/competition/locale/en-AU/LC_MESSAGES/django.po,sha256=AnVoD_YBfn8fOg1qbHY_c5o01g20y37DWXgB8kcGWjo,63245
@@ -961,12 +961,12 @@
 tournamentcontrol/competition/tests/test_dashboard.py,sha256=SrkihAqiIsVGzqfhxwRUbDmjQ2Cp1aDIRJ9YNEop-gQ,1837
 tournamentcontrol/competition/tests/test_draw.py,sha256=c5V5Xg-9_hhxkhJMyeKbCKx4ej7r3SjHvUiSF4EYd40,2299
 tournamentcontrol/competition/tests/test_formsets.py,sha256=-Tuhf3rXQvjDgMhDjXiLdoJ27_slXLjywY15-uicKDY,7104
 tournamentcontrol/competition/tests/test_rank.py,sha256=F4sufcksF0tk8rhWK_cqaQa3Cz0JzFfFjjiMmBAYSrM,4308
 tournamentcontrol/competition/tests/test_signals.py,sha256=Q6FWckv9YJ2AuKnL6CXIjiK2O_xw2RFzLX733DbJ6jQ,1925
 tournamentcontrol/competition/tests/test_utils.py,sha256=zTTHcQsbYRRSYwL6OgejaPIi95s0NYj8o0wecg0RpaY,1240
 tournamentcontrol/competition/tests/urls.py,sha256=Yjvtda9XI_bsgMQkJMY9HjMWwLHt21Rg6TpMQytwW6M,339
-vitriolic-3.3.0.dist-info/LICENSE,sha256=Np-ji6hKE5J6mhfFdJ9Ql9O3LLx2jnyooJJfTUOV1Lw,1524
-vitriolic-3.3.0.dist-info/METADATA,sha256=GfeMW2ZsIWLfQYbTFUVcopIYsq6C7XBSsflGBi_KBGs,5079
-vitriolic-3.3.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-vitriolic-3.3.0.dist-info/top_level.txt,sha256=1JEz19hAABkOzzD1kHGP4Z4_w1E9UI0azSWwUsWE8ms,34
-vitriolic-3.3.0.dist-info/RECORD,,
+vitriolic-3.3.1.dist-info/LICENSE,sha256=Np-ji6hKE5J6mhfFdJ9Ql9O3LLx2jnyooJJfTUOV1Lw,1524
+vitriolic-3.3.1.dist-info/METADATA,sha256=afwEU6DmEUC1zddfe_W5cGQBmwoNGIse94jkhOtKcZE,5079
+vitriolic-3.3.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+vitriolic-3.3.1.dist-info/top_level.txt,sha256=1JEz19hAABkOzzD1kHGP4Z4_w1E9UI0azSWwUsWE8ms,34
+vitriolic-3.3.1.dist-info/RECORD,,
```

